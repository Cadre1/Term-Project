<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Automated Nerf Gun Turret: src/main.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Automated Nerf Gun Turret
   </div>
   <div id="projectbrief">ME 405 Term Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('main_8py.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">main.py File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This program manages and allows two cotasks, task1_fun (Timing) and task2_fun (Shooting), to be run without blocking each other upon the microcontroller's reset.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3604ba3cb5e82f0236d3c20903d2c1db" id="r_a3604ba3cb5e82f0236d3c20903d2c1db"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3604ba3cb5e82f0236d3c20903d2c1db">main.task1_fun</a> (shares)</td></tr>
<tr class="memdesc:a3604ba3cb5e82f0236d3c20903d2c1db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timing task that determines how long each section of the shootout will last.  <br /></td></tr>
<tr class="separator:a3604ba3cb5e82f0236d3c20903d2c1db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99683bfda5aff485862a4eb1e59ed25e" id="r_a99683bfda5aff485862a4eb1e59ed25e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99683bfda5aff485862a4eb1e59ed25e">main.task2_fun</a> (shares)</td></tr>
<tr class="memdesc:a99683bfda5aff485862a4eb1e59ed25e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shooting task that controls the targetting, panning, and firing of the Nerf gun turret with its timings to change certain states set by the Timer task.  <br /></td></tr>
<tr class="separator:a99683bfda5aff485862a4eb1e59ed25e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad4a7951defdf0fe54e19348011ec7395" id="r_ad4a7951defdf0fe54e19348011ec7395"><td class="memItemLeft" align="right" valign="top"><a id="ad4a7951defdf0fe54e19348011ec7395" name="ad4a7951defdf0fe54e19348011ec7395"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.Start_Flag</b> = task_share.Share('h', thread_protect=False, name=&quot;Start Flag&quot;)</td></tr>
<tr class="separator:ad4a7951defdf0fe54e19348011ec7395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f8bd62824c56923ac05ade570d2e3a" id="r_a57f8bd62824c56923ac05ade570d2e3a"><td class="memItemLeft" align="right" valign="top"><a id="a57f8bd62824c56923ac05ade570d2e3a" name="a57f8bd62824c56923ac05ade570d2e3a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.Stop_Flag</b> = task_share.Share('h', thread_protect=False, name=&quot;Stop Flag&quot;)</td></tr>
<tr class="separator:a57f8bd62824c56923ac05ade570d2e3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b1df2c343a0e7559abf6fc6a541b4e1" id="r_a1b1df2c343a0e7559abf6fc6a541b4e1"><td class="memItemLeft" align="right" valign="top"><a id="a1b1df2c343a0e7559abf6fc6a541b4e1" name="a1b1df2c343a0e7559abf6fc6a541b4e1"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.Return_Flag</b> = task_share.Share('h', thread_protect=False, name=&quot;Return Flag&quot;)</td></tr>
<tr class="separator:a1b1df2c343a0e7559abf6fc6a541b4e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a525997fac9f4d6604a42c918a7d2e275" id="r_a525997fac9f4d6604a42c918a7d2e275"><td class="memItemLeft" align="right" valign="top"><a id="a525997fac9f4d6604a42c918a7d2e275" name="a525997fac9f4d6604a42c918a7d2e275"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>main.Button_Flag</b> = task_share.Share('h', thread_protect=False, name=&quot;Button Flag&quot;)</td></tr>
<tr class="separator:a525997fac9f4d6604a42c918a7d2e275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4b8f4290f8d32e70654f6deb864787f" id="r_af4b8f4290f8d32e70654f6deb864787f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4b8f4290f8d32e70654f6deb864787f">main.task1</a></td></tr>
<tr class="separator:af4b8f4290f8d32e70654f6deb864787f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99d189b8f9eb3784cf7d4e5c3241b562" id="r_a99d189b8f9eb3784cf7d4e5c3241b562"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99d189b8f9eb3784cf7d4e5c3241b562">main.task2</a></td></tr>
<tr class="separator:a99d189b8f9eb3784cf7d4e5c3241b562"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This program manages and allows two cotasks, task1_fun (Timing) and task2_fun (Shooting), to be run without blocking each other upon the microcontroller's reset. </p>
<p>The Timing task initializes a pin to take an input from a button in which it then begins to track each of the required timers for the shootout. Each section of the shootout will have its corresponding flag set when each timer ends. The Shooting task initializes the pin controlling the MOSFET output to the Nerf gun flywheel, the I2C channel for the thermal camera, the pins and timers for the panning motor and encoder, and the pin, timer, and PID controller for the servo motor. This task will then manage the motor control for initial rotation using the motor driver, encoder, and PID controller, the centroid/hotspot detection using the thermal camera, the aiming at the determined centroid/hotspot, firing using the pin-to-flywheel circuit and servo motor, and rotation back to its starting point. During each of the shootout's sections, the states will be watching for changes in the timer's flag changes and change modes correspondingly. Notes:</p><ul>
<li>Each of these tasks' finite state machines can be found in the README on Github.</li>
<li>Tuning of controller gains, thermal readings, and timings may be adjusted per the requirements of operation by searching for "EDIT:" comments. </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3604ba3cb5e82f0236d3c20903d2c1db" name="a3604ba3cb5e82f0236d3c20903d2c1db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3604ba3cb5e82f0236d3c20903d2c1db">&#9670;&#160;</a></span>task1_fun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task1_fun </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>shares</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Timing task that determines how long each section of the shootout will last. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shares</td><td>A list holding the four shares, Start_Flag, Stop_Flag, Return_Flag, and Button_Flag set by this task </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a99683bfda5aff485862a4eb1e59ed25e" name="a99683bfda5aff485862a4eb1e59ed25e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99683bfda5aff485862a4eb1e59ed25e">&#9670;&#160;</a></span>task2_fun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task2_fun </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>shares</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shooting task that controls the targetting, panning, and firing of the Nerf gun turret with its timings to change certain states set by the Timer task. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shares</td><td>A list holding the three shares, Start_Flag, Stop_Flag, Return_Flag, and Button_Flag used by this task </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af4b8f4290f8d32e70654f6deb864787f" name="af4b8f4290f8d32e70654f6deb864787f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4b8f4290f8d32e70654f6deb864787f">&#9670;&#160;</a></span>task1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task1</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  cotask.Task(task1_fun, name=<span class="stringliteral">&quot;Task_1&quot;</span>, priority=2, period=20,</div>
<div class="line"><span class="lineno">    2</span>                        profile=<span class="keyword">True</span>, trace=<span class="keyword">False</span>, shares=(Start_Flag, Stop_Flag, Return_Flag, Button_Flag))</div>
</div><!-- fragment -->
</div>
</div>
<a id="a99d189b8f9eb3784cf7d4e5c3241b562" name="a99d189b8f9eb3784cf7d4e5c3241b562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99d189b8f9eb3784cf7d4e5c3241b562">&#9670;&#160;</a></span>task2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main.task2</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  cotask.Task(task2_fun, name=<span class="stringliteral">&quot;Task_2&quot;</span>, priority=1, period=7,</div>
<div class="line"><span class="lineno">    2</span>                        profile=<span class="keyword">True</span>, trace=<span class="keyword">False</span>, shares=(Start_Flag, Stop_Flag, Return_Flag, Button_Flag))</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="main_8py.html">main.py</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
